namespace async_multi_effect_test

use beagle.async as async
use beagle.core as core
use beagle.effect as effect

// Test multiple sequential effects

fn main() {
    println("=== Multiple Effect Test ===")

    let handler = async/BlockingAsyncHandler {}

    let result = handle effect/Handler(async/Async) with handler {
        println("First sleep...")
        let r1 = async/sleep(10)
        println("First sleep done:", r1)

        println("Second sleep...")
        let r2 = async/sleep(10)
        println("Second sleep done:", r2)

        println("Third sleep...")
        let r3 = async/sleep(10)
        println("Third sleep done:", r3)

        println("=== All done ===")
        42
    }

    println("Result:", result)
}

// Expect
// === Multiple Effect Test ===
// First sleep...
// First sleep done: Result.Ok { value: null }
// Second sleep...
// Second sleep done: Result.Ok { value: null }
// Third sleep...
// Third sleep done: Result.Ok { value: null }
// === All done ===
// Result: 42
