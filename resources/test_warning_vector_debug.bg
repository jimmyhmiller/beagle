namespace test_warning_vector

use beagle.primitive as primitive
use beagle.core as core

fn main() {
    // Trigger a diagnostic by evaling code with non-exhaustive match
    eval("
        enum MyEnum {
            Variant1,
            Variant2,
            Variant3
        }

        fn test_match(val) {
            match val {
                MyEnum.Variant1 => \"one\",
                MyEnum.Variant2 => \"two\"
            }
        }

        test_match(MyEnum.Variant1)
    ")

    let diags = core/diagnostics()
    println("Got diagnostics vector")
    println("Length:")
    println(core/length(diags))

    if core/length(diags) > 0 {
        println("Getting first diagnostic...")
        let first = core/get(diags, 0)
        println("Got first diagnostic, pointer value:")
        primitive/_println_raw(first)

        println("Is object?:")
        println(primitive/is_object(first))

        println("Done")
    }

    "done"
}
