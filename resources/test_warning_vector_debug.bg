namespace test_warning_vector

import "beagle.primitive" as primitive
import "beagle.core" as core

fn main() {
    // Trigger a warning by evaling code with non-exhaustive match
    eval("
        enum MyEnum {
            Variant1,
            Variant2,
            Variant3
        }

        fn test_match(val) {
            match val {
                MyEnum.Variant1 => \"one\",
                MyEnum.Variant2 => \"two\"
            }
        }

        test_match(MyEnum.Variant1)
    ")

    let warnings = core/compiler-warnings()
    println("Got warnings vector")
    println("Length:")
    println(core/length(warnings))

    if core/length(warnings) > 0 {
        println("Getting first warning...")
        let first = core/get(warnings, 0)
        println("Got first warning, pointer value:")
        primitive/_println_raw(first)

        println("Is object?:")
        println(primitive/is_object(first))

        println("Done")
    }

    "done"
}
