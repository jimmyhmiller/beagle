namespace array_index_boundary_test

use raw-mutable-array as arr
fn test_index(a, idx) {
    arr/write-field(a, idx, "test")
    let v = arr/read-field(a, idx)
    if v == null {
        print(idx)
        println(": FAIL (null)")
    } else {
        print(idx)
        println(": OK")
    }
}

fn main() {
    let a = arr/new-array(125000)

    test_index(a, 50000)
    test_index(a, 52000)
    test_index(a, 54000)
    test_index(a, 55000)
    test_index(a, 56000)
    test_index(a, 57000)
    test_index(a, 58000)
    test_index(a, 59000)
    test_index(a, 60000)

    ""
}
