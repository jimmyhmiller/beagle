namespace handler_test

use beagle.effect as effect

// Test basic effect handlers with parameterized protocols

// Define an effect enum
enum Log {
    Info { message }
}

// Define a struct that will handle Log effects
struct ConsoleLogger {}

// Implement Handler(Log) for ConsoleLogger
extend ConsoleLogger with effect/Handler(Log) {
    fn handle(self, op, resume) {
        println("in handler")
        resume(null)
    }
}

fn main() {
    // Test: basic handler that logs and resumes
    let logger = ConsoleLogger {}
    let result = handle effect/Handler(Log) with logger {
        perform Log.Info { message: "Hello from handler!" }
        println("After perform")
        42
    }
    println(result)
    println("Done")
}

// @beagle.core.snapshot
// in handler
// After perform
// 42
// Done
