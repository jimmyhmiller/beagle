namespace trig_test

// Test trigonometric functions using approximate comparisons
// to handle platform differences in float precision

fn approx-eq(a, b, tolerance) {
    abs(a - b) < tolerance
}

fn check(name, actual, expected) {
    let tolerance = 0.0001
    if approx-eq(actual, expected, tolerance) {
        println(name ++ ": pass")
    } else {
        println(name ++ ": FAIL - expected " ++ to-string(expected) ++ " got " ++ to-string(actual))
    }
}

fn main() {
    // Define PI locally since it's not a built-in constant yet
    let PI = 3.141592653589793
    let PI_2 = PI / 2.0  // PI/2 = 1.5707963267948966
    let PI_4 = PI / 4.0  // PI/4 = 0.7853981633974483

    // Test tan
    println("tan tests:")
    check("tan(0.0)", tan(0.0), 0.0)
    check("tan(PI/4)", tan(PI_4), 1.0)

    // Test asin
    println("asin tests:")
    check("asin(0.0)", asin(0.0), 0.0)
    check("asin(0.5)", asin(0.5), 0.5235987755982989)
    check("asin(1.0)", asin(1.0), PI_2)

    // Test acos
    println("acos tests:")
    check("acos(1.0)", acos(1.0), 0.0)
    check("acos(0.0)", acos(0.0), PI_2)
    check("acos(0.5)", acos(0.5), 1.0471975511965976)

    // Test atan
    println("atan tests:")
    check("atan(0.0)", atan(0.0), 0.0)
    check("atan(1.0)", atan(1.0), PI_4)
    check("atan(-1.0)", atan(to-float(-1)), 0.0 - PI_4)

    // Test atan2
    println("atan2 tests:")
    check("atan2(0.0, 1.0)", atan2(0.0, 1.0), 0.0)
    check("atan2(1.0, 1.0)", atan2(1.0, 1.0), PI_4)
    check("atan2(1.0, 0.0)", atan2(1.0, 0.0), PI_2)
    check("atan2(-1.0, 0.0)", atan2(to-float(-1), 0.0), 0.0 - PI_2)

    // Verify inverse relationships
    println("inverse relationship tests:")
    let x = 0.7
    check("asin(sin(0.7))", asin(sin(x)), x)
    check("acos(cos(0.7))", acos(cos(x)), x)
    check("atan(tan(0.7))", atan(tan(x)), x)

    ""
}

// @beagle.core.snapshot
// tan tests:
// tan(0.0): pass
// tan(PI/4): pass
// asin tests:
// asin(0.0): pass
// asin(0.5): pass
// asin(1.0): pass
// acos tests:
// acos(1.0): pass
// acos(0.0): pass
// acos(0.5): pass
// atan tests:
// atan(0.0): pass
// atan(1.0): pass
// atan(-1.0): pass
// atan2 tests:
// atan2(0.0, 1.0): pass
// atan2(1.0, 1.0): pass
// atan2(1.0, 0.0): pass
// atan2(-1.0, 0.0): pass
// inverse relationship tests:
// asin(sin(0.7)): pass
// acos(cos(0.7)): pass
// atan(tan(0.7)): pass
