namespace exp_log_test

// Test exponential and logarithmic functions using approximate comparisons
// to handle platform differences in float precision

fn approx-eq(a, b, tolerance) {
    abs(a - b) < tolerance
}

fn check(name, actual, expected) {
    let tolerance = 0.0001
    if approx-eq(actual, expected, tolerance) {
        println(name ++ ": pass")
    } else {
        println(name ++ ": FAIL - expected " ++ to-string(expected) ++ " got " ++ to-string(actual))
    }
}

fn main() {
    // Define E locally since it's not a built-in constant yet
    let E = 2.718281828459045

    // Test exp
    println("exp tests:")
    check("exp(0.0)", exp(0.0), 1.0)
    check("exp(1.0)", exp(1.0), E)
    check("exp(2.0)", exp(2.0), 7.38905609893065)

    // Test log (natural logarithm)
    println("log tests:")
    check("log(1.0)", log(1.0), 0.0)
    check("log(E)", log(E), 1.0)
    check("log(10.0)", log(10.0), 2.302585092994046)

    // Test log10
    println("log10 tests:")
    check("log10(1.0)", log10(1.0), 0.0)
    check("log10(10.0)", log10(10.0), 1.0)
    check("log10(100.0)", log10(100.0), 2.0)
    check("log10(1000.0)", log10(1000.0), 3.0)

    // Test log2
    println("log2 tests:")
    check("log2(1.0)", log2(1.0), 0.0)
    check("log2(2.0)", log2(2.0), 1.0)
    check("log2(4.0)", log2(4.0), 2.0)
    check("log2(8.0)", log2(8.0), 3.0)
    check("log2(1024.0)", log2(1024.0), 10.0)

    // Test pow
    println("pow tests:")
    check("pow(2.0, 3.0)", pow(2.0, 3.0), 8.0)
    check("pow(10.0, 2.0)", pow(10.0, 2.0), 100.0)
    check("pow(5.0, 0.0)", pow(5.0, 0.0), 1.0)
    check("pow(2.0, -1.0)", pow(2.0, 0.0 - 1.0), 0.5)
    check("pow(4.0, 0.5)", pow(4.0, 0.5), 2.0)
    check("pow(27.0, 1/3)", pow(27.0, 1.0 / 3.0), 3.0)

    // Verify inverse relationships
    println("inverse relationship tests:")
    check("log(exp(5.0))", log(exp(5.0)), 5.0)
    check("pow(2.0, log2(16.0))", pow(2.0, log2(16.0)), 16.0)

    ""
}

// Expect
// exp tests:
// exp(0.0): pass
// exp(1.0): pass
// exp(2.0): pass
// log tests:
// log(1.0): pass
// log(E): pass
// log(10.0): pass
// log10 tests:
// log10(1.0): pass
// log10(10.0): pass
// log10(100.0): pass
// log10(1000.0): pass
// log2 tests:
// log2(1.0): pass
// log2(2.0): pass
// log2(4.0): pass
// log2(8.0): pass
// log2(1024.0): pass
// pow tests:
// pow(2.0, 3.0): pass
// pow(10.0, 2.0): pass
// pow(5.0, 0.0): pass
// pow(2.0, -1.0): pass
// pow(4.0, 0.5): pass
// pow(27.0, 1/3): pass
// inverse relationship tests:
// log(exp(5.0)): pass
// pow(2.0, log2(16.0)): pass
