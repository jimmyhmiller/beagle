namespace protocol-test

import "persistent-vector" as vector
import "beagle.builtin" as builtin
import "beagle.primitive" as primitive


struct Point {
    x
    y
}

struct Size {
    width
    height
}

protocol Axis {
    fn get-x(self)
    fn get-y(self)
}


extend Point with Axis {
    fn get-x(self) {
        self.x
    }

    fn get-y(self) {
        self.y
    }
}

extend Size with Axis {
    fn get-x(self) {
        self.width
    }

    fn get-y(self) {
        self.height
    }
}


protocol Format {
    fn format(self) {
        "no format"
    }
}

extend String with Format {
    fn format(self) {
        self
    }
}


fn main() {
    println(vector/PersistentVector.name)
    println(Indexed)
    let x = [2];
    println(x[0])
    println(primitive/read-struct-id(x) == vector/PersistentVector.id)
    println(instance-of(x, vector/PersistentVector))
    println(instance-of(2, vector/PersistentVector))


    let point = Point {
        x: 1,
        y: 2
    }

    let size = Size {
        width: 3,
        height: 4
    }

    println(get-x(point))
    println(get-y(point))
    println(get-x(size))
    println(get-y(size))
    println(format("test"))
    println(format(2))
    "done"
}

// Expect
// persistent-vector/PersistentVector
// Protocol { name: "beagle.core/Indexed" }
// 2
// true
// true
// false
// 1
// 2
// 3
// 4
// test
// no format
